<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mini Replit â€” JS, Python, Web App & Node (WebContainers)</title>
  <style>
    :root {
      --bg: #0f172a; /* slate-900 */
      --panel: #111827; /* gray-900 */
      --muted: #64748b; /* slate-500 */
      --text: #e2e8f0; /* slate-200 */
      --accent: #22d3ee; /* cyan-400 */
      --btn: #1f2937; /* gray-800 */
      --bad: #ef4444; /* red-500 */
      --good: #10b981; /* emerald-500 */
      --warn: #f59e0b; /* amber-500 */
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; background: var(--bg); color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
        Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji",
        "Segoe UI Emoji";
    }
    .app { display: grid; grid-template-rows: auto 1fr; height: 100%; }
    header {
      display: flex; align-items: center; gap: .6rem; padding: .6rem .9rem;
      border-bottom: 1px solid var(--border); background: var(--panel);
      position: sticky; top: 0; z-index: 10;
    }
    header h1 { font-size: 1rem; margin: 0; color: #cbd5e1; }
    header .dot { width: .6rem; height: .6rem; border-radius: 999px; background: var(--accent); box-shadow: 0 0 12px var(--accent); }
    select, button, input[type="text"] {
      background: var(--btn); color: var(--text); border: 1px solid #374151;
      padding: .45rem .6rem; border-radius: .5rem; font-size: .9rem;
    }
    button { cursor: pointer; }
    button:disabled { opacity: .6; cursor: not-allowed; }
    .toolbar { display: flex; gap: .4rem; align-items: center; margin-left: auto; }

    .main { display: grid; grid-template-columns: 1fr 40%; height: calc(100vh - 56px); }
    .pane { border-right: 1px solid var(--border); }
    .pane:last-child { border-right: none; }

    .workspace { display: grid; grid-template-rows: auto 1fr; height: 100%; }
    .filebar { display: none; gap: .5rem; align-items: center; padding: .5rem .75rem; border-bottom: 1px solid var(--border); background: #0b1220; }
    .filebar[aria-hidden="false"] { display: flex; }
    #fileSelect { min-width: 180px; }

    #editor-ace, #editor-ta { width: 100%; height: 100%; }
    #editor-ta {
      display: none; resize: none; outline: none; border: 0; padding: .75rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: #0b1220; color: #e2e8f0; line-height: 1.45; font-size: 14px;
    }

    .right { display: grid; grid-template-rows: auto 1fr; height: 100%; }
    .right-tabs { display: flex; gap: .5rem; align-items: center; padding: .5rem .75rem; border-bottom: 1px solid var(--border); background: #0b1220; }
    .right-tabs .tab { padding: .25rem .6rem; border: 1px solid #334155; border-radius: .45rem; cursor: pointer; font-size: .85rem; color: #cbd5e1; }
    .right-tabs .tab[aria-selected="true"] { background: #111827; }

    .preview-wrap { display: none; height: 50%; border-bottom: 1px solid var(--border); }
    .preview-wrap[aria-hidden="false"] { display: block; }
    #preview { width: 100%; height: 100%; border: 0; background: white; }

    .console { display: flex; flex-direction: column; height: 100%; }
    .console-body { padding: .75rem; overflow: auto; height: 100%; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: .9rem; white-space: pre-wrap; }
    .line { padding: .15rem 0; }
    .line.log::before { content: "âŸ¶ "; color: #60a5fa; }
    .line.err { color: var(--bad); }
    .line.warn { color: var(--warn); }
    .line.ok { color: var(--good); }

    .kbd { font-family: ui-monospace, monospace; background: #0b1220; border: 1px solid #374151; padding: 0 .35rem; border-radius: .35rem; font-size: .8rem; color: #cbd5e1; }

    .status { display: inline-flex; align-items: center; gap: .4rem; }
    .pill { padding: .15rem .5rem; border-radius: 999px; border: 1px solid #334155; color: #cbd5e1; font-size: .75rem; }
  </style>
  <!-- We'll dynamically load Ace, Pyodide, and WebContainers to avoid hard failures in sandboxed hosts. -->
  <script type="module" src="/main.js"></script>
</head>
<body>
  <div class="app">
    <header>
      <span class="dot" aria-hidden="true"></span>
      <h1>Mini Replit <span style="color:#94a3b8">â€” JS â€¢ Python â€¢ Web App â€¢ Node</span></h1>
      <div class="toolbar">
        <label for="mode" style="color:#cbd5e1">Mode</label>
        <select id="mode" aria-label="Mode selector">
          <option value="javascript">JavaScript</option>
          <option value="python">Python</option>
          <option value="webapp">Web App</option>
          <option value="node">Node (WebContainers)</option>
        </select>
        <button id="runBtn" title="Run (Ctrl/âŒ˜+Enter)">â–¶ Run</button>
        <button id="stopBtn" title="Stop execution">â–  Stop</button>
        <button id="clearBtn" title="Clear console">âŸ² Clear</button>
        <button id="installBtn" title="npm install (Node mode only)" style="display:none">â¬‡ï¸Ž Install deps</button>
        <button id="testBtn" title="Run builtâ€‘in tests">âœ“ Selfâ€‘test</button>
        <span class="status"><span id="statusPill" class="pill">idle</span></span>
      </div>
    </header>

    <div class="main">
      <div class="pane workspace">
        <div id="filebar" class="filebar" aria-hidden="true">
          <strong>Files</strong>
          <select id="fileSelect"></select>
          <button id="addFile">ï¼‹ New</button>
          <button id="renFile">âœŽ Rename</button>
          <button id="delFile">ðŸ—‘ Delete</button>
          <button id="resetVFS">â†º Reset</button>
        </div>
        <div id="editor-ace" aria-label="Code editor (Ace)"></div>
        <textarea id="editor-ta" aria-label="Code editor (fallback)"></textarea>
      </div>

      <div class="pane right">
        <div class="right-tabs">
          <span class="tab" aria-selected="true">Preview + Console</span>
        </div>
        <div id="previewWrap" class="preview-wrap" aria-hidden="true">
          <iframe id="preview"></iframe>
        </div>
        <div class="console">
          <div id="console" class="console-body" role="log" aria-live="polite"></div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
